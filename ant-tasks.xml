<?xml version="1.0" encoding="UTF-8"?>
<!-- +=====================================================================+ -->
<!-- |                                                                     | -->
<!-- |                      a n t - t a s k s . x m l                      | -->
<!-- |                                                                     | -->
<!-- +=====================================================================+ -->
<project name="proxymusic">
    
    <description>
        Collection of Ant tasks meant to be called from Maven.
    </description>
    
    <property name="generated.src.dir" location="${basedir}/target/generated-sources/java" /> 
    
    <!-- retrieve-id -->
    <target name="retrieve-id"
            description="Retrieve Hg information">
        <exec executable="git" outputproperty="program.revision">
            <arg line='log -1 --pretty=format:"%h"' />
        </exec>
        <echo message="-- program.revision=${program.revision}" />
    </target>
        
    <!-- generate-program-id -->
    <target name="generate-program-id"
            depends="retrieve-id"
            description="Write a Java class to gather program identification">
        <echo message="-- Writing to file ${generated.src.dir}/com/audiveris/proxymusic/util/ProgramId.java" />
        <mkdir dir="${generated.src.dir}/org/audiveris/proxymusic/util" />
        <echo file="${generated.src.dir}/org/audiveris/proxymusic/util/ProgramId.java"><![CDATA[
package org.audiveris.proxymusic.util;

/** 
 * Class {@code ProgramId} provides full program identification.
 * This code is generated by an Ant target using Hg information.
 */
public class ProgramId 
{
    /** Precise program name: {@value} */
    public static final java.lang.String NAME = "${program.name}";

    /** Precise program version: {@value} */
    public static final java.lang.String VERSION = "${program.version}";

    /** Precise program revision: {@value} */
    public static final java.lang.String REVISION = "${program.revision}";
}]]>
        </echo> 
    </target>

</project>
